---
title: "Homework 4: Exploratory Data Analysis (20 pts)"
output: html_document
---

### Objective
- practice exploratory analysis/descriptive analysis in R

### Task
- follow the prompts below
- include all relavent code
- cite sources in which you used for significant help

TOTAL POINTS: 20
**You will submit the html output.**

This assignment will use the popular Titanic dataset.
Find the data dictionary for the dataset here: https://www.kaggle.com/competitions/titanic/data
```{r, message=FALSE}
#Library 
library("tidyverse")
library("forcats")
library("ggplot2")
```

```{r}
# Load the dataset; assign the dataframe to an object called 'titanic'
titanic <- read.csv("~/Desktop/SPRING 2023/DS 2003/titanic.csv")
```

## Question 1 (0.5 point)
```{r}
# Look at the first 6 rows of data
head(titanic)
```

## Question 2 (2 point)
```{r}
# Look at the structure of your data - specifically the columns `sex` and `survived`. Change the data type as needed.
table(titanic$sex)
titanic$sex <- fct_collapse(titanic$sex, 
                                      female =c("female"), 
                            male =c("male"))
table(titanic$survived)
titanic$survived <- as.factor(titanic$survived)
str(titanic)

```

## Question 3 (.5 points)
```{r}
# print summary statistics for the dataset
summary(titanic)
```

## Question 4 (1 point)
```{r}
# subset the dataframe to include passengers in 2nd class and include the columns for name, age, and sex
titanic_2 <- titanic %>%
  filter(pclass == 2) %>%
  select(c("name","age", "sex"))
titanic_2

```

## Question 5 (2 point)
```{r}
# How many NAs are in the full dataset? 
titanic[titanic == ""] <- NA 
sum(is.na(titanic))

# How many NAs are in the 'age' column? (hint: you may need to Google)
sum(is.na(titanic$age))
```

## Question 6 (1 point)
```{r}
# Recode the variable 'sex' so that 'male' becomes 'm' and 'female' becomes 'f'
titanic$sex <- fct_collapse(titanic$sex, 
                                      f =c("female"), 
                            m =c("male"))
(titanic$sex)

```

## Question 7 (1 point)
```{r}
# What is the average ticket price for a first class ticket?
# (optional: round to 2 decimal points)

titanic_average <- titanic %>%
  filter(pclass == 1) %>%
  select(c("fare")) %>%
  summarize(average_fare = round(mean(fare), digits = 2))
titanic_average
  


```

## Question 8 (1 point)
```{r}
# Plot a histogram for the fare price 
p <- ggplot(titanic, aes(x=fare)) + 
  geom_histogram(fill = '#1b98e0') +theme_classic()

p <- p + labs(title = "Histogram of the fare price ",y = "Percentage")
p

```

## Question 9 (2 point)
```{r}
# Graph fare price histograms by embarkment point using a single ggplot() call. 
hist(titanic$fare, main="Histogram of the fare price ",
xlab="Fare Price",
col ='#1b98e0')+ 
  theme_classic()

```


## Question 10 (1 point)
```{r}
# Write one sentence interpreting the graph from Question  9

#The graph of fare price is right skewed

```

## Question 11 (2 point)
```{r}
# Create a barplot of cabin class vs sex (use proportions)
p <-ggplot(titanic, aes(x=pclass, fill=sex))+
  geom_bar(position = "fill")+ 
  scale_fill_manual(values = c("f" = "#6CDC76",
                               "m" = "#7BA9FF"))+
 theme_classic()

p <- p + labs(title = 'Barplot of cabin class vs sex ',y = "Percentage")
p

```

## Question 12 (2 point)

```{r}
# Create a graph that depicts the prevalence of survival based on passenger's sex.

p <- ggplot(titanic, aes(x=survived, fill=sex,))+
  geom_bar(position = "fill")+scale_fill_manual(values = c("f" = "#6CDC76",
                               "m" = "#7BA9FF"))+ 
  scale_x_discrete(labels= c("0"="No","1"="Yes"))+
  theme_classic()
 
p <- p + labs(title = "Prevalence of survival based on passenger's sex", y =  "Percentage")
p

```

## Question 13 (4 points)

```{r}
# For the 4 charts you made above:

# 1) change the color of the graph away from the default? 
# 2) include appropriate/easy to interpret chart labels? 
# 3) use a consistent theme? I used the theme of minimal 
```





